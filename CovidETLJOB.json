{
	"jobConfig": {
		"name": "CovidETLJOB",
		"description": "",
		"role": "arn:aws:iam::918006632786:role/s3-glue-role",
		"command": "pythonshell",
		"version": "3.0",
		"runtime": null,
		"workerType": null,
		"numberOfWorkers": null,
		"maxCapacity": 0.0625,
		"maxRetries": 0,
		"timeout": 2880,
		"maxConcurrentRuns": 1,
		"security": "none",
		"scriptName": "CovidETLJOB.py",
		"scriptLocation": "s3://aws-glue-assets-918006632786-ap-south-1/scripts/",
		"language": "python-3.9",
		"jobParameters": [],
		"tags": [],
		"jobMode": "DEVELOPER_MODE",
		"createdOn": "2023-08-21T08:45:53.601Z",
		"developerMode": true,
		"connectionsList": [],
		"temporaryDirectory": "s3://aws-glue-assets-918006632786-ap-south-1/temporary/",
		"glueHiveMetastore": true,
		"etlAutoTuning": false,
		"pythonPath": "s3://ath-covid-de-project/packages/redshift_connector-2.0.913-py3-none-any.whl",
		"flexExecution": false,
		"minFlexWorkers": null
	},
	"hasBeenSaved": false,
	"script": "import sys\nimport redshift_connector\nconn = redshift_connector.connect(\n    host=\"redshift-cluster-1.c6hyahorsvry.ap-south-1.redshift.amazonaws.com\",\n    database=\"dev\",\n    user=\"awsuser\",\n    password=\"rDAtharva123\"\n)\n\nconn.autocommit = True\n\ncursor = redshift_connector.Cursor = conn.cursor()\n\n### Create tables in redshift ###\n\ncursor.execute(\"\"\"\nCREATE TABLE \"dimDate\" (\n\"index\" INTEGER,\n  \"fips\" REAL,\n  \"date\" TIMESTAMP,\n  \"year\" INTEGER,\n  \"month\" INTEGER,\n  \"day_of_week\" INTEGER\n)\n\"\"\")\n\ncursor.execute(\"\"\"\nCREATE TABLE \"dimHospital\" (\n\"index\" INTEGER,\n  \"fips\" REAL,\n  \"state_name\" TEXT,\n  \"latitude\" REAL,\n  \"longtitude\" REAL,\n  \"hq_address\" TEXT,\n  \"hospital_name\" TEXT,\n  \"hospital_type\" TEXT,\n  \"hq_city\" TEXT,\n  \"hq_state\" TEXT\n)\n\"\"\")\n\ncursor.execute(\"\"\"\nCREATE TABLE \"factCovid\" (\n\"index\" INTEGER,\n  \"fips\" REAL,\n  \"province_state\" TEXT,\n  \"country_region\" TEXT,\n  \"confirmed\" REAL,\n  \"deaths\" REAL,\n  \"recovered\" REAL,\n  \"active\" REAL,\n  \"date\" INTEGER,\n  \"positive\" INTEGER,\n  \"negative\" REAL,\n  \"hospitalizedcurrently\" REAL,\n  \"hospitalized\" REAL,\n  \"hospitalizeddischarged\" REAL\n)\n\"\"\")\n\ncursor.execute(\"\"\"\nCREATE TABLE \"dimRegion\" (\n\"index\" INTEGER,\n  \"fips\" REAL,\n  \"province_state\" TEXT,\n  \"country_region\" TEXT,\n  \"latitude\" REAL,\n  \"longitude\" REAL,\n  \"county\" TEXT,\n  \"state\" TEXT\n)\n\"\"\")\n\n### Copy Data from S3 to Redshit ###\n\ncursor.execute(\"\"\"\ncopy dimDate from 's3://ath-covid-de-project/output/dimDate.csv'\ncredentials 'aws_access_key_id=AKIA5LPLVSFJOFGPZO6T;aws_secret_access_key=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'\ndelimiter ','\nregion 'ap-south-1'\nIGNOREHEADER 1\n\"\"\")\n\ncursor.execute(\"\"\"\ncopy dimHospital from 's3://ath-covid-de-project/output/dimHospital.csv'\ncredentials 'aws_access_key_id=AKIA5LPLVSFJOFGPZO6T;aws_secret_access_key=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'\ndelimiter ','\nregion 'ap-south-1'\nIGNOREHEADER 1\n\"\"\")\n\ncursor.execute(\"\"\"\ncopy factCovid from 's3://ath-covid-de-project/output/factCovid.csv'\ncredentials 'aws_access_key_id=AKIA5LPLVSFJOFGPZO6T;aws_secret_access_key=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'\ndelimiter ','\nregion 'ap-south-1'\nIGNOREHEADER 1\nMAXERROR 10\nSTATUPDATE ON\n\"\"\")\n\ncursor.execute(\"\"\"\ncopy dimRegion from 's3://ath-covid-de-project/output/dimRegion.csv'\ncredentials 'aws_access_key_id=AKIA5LPLVSFJOFGPZO6T;aws_secret_access_key=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'\ndelimiter ','\nregion 'ap-south-1'\nIGNOREHEADER 1\nMAXERROR 10\nSTATUPDATE ON\n\"\"\")"
}